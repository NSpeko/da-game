!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=11)}([function(e,t){},function(e,t){class i{constructor(e,t,i,n){this.place={x:e*PX,y:t*PX},this.type=i,this.name=n||"John Smith",this.healPoints=MAX_HEAL_POINTS}redraw(){this.clearImage(),this.drawImage(),this.drawInfo(),this.drawHP()}drawName(e){actorsContext.font=`${NAME_SIZE*PX}px Verdana`,actorsContext.fillStyle="black",actorsContext.textAlign="center",actorsContext.fillText(this.name,this.place.x-e*PX,this.place.y-NAME_WRAP*PX)}drawHP(e){let t=this.healPoints/MAX_HEAL_POINTS;actorsContext.fillStyle="red",actorsContext.fillRect(this.place.x-e,this.place.y-HP_WRAP*PX,t*this.image.width,HP_LINE_HEIGHT*PX),actorsContext.fillStyle="black",actorsContext.strokeRect(this.place.x-e,this.place.y-HP_WRAP*PX,this.image.width,HP_LINE_HEIGHT*PX)}rebuild(e,t){this.place={x:e*PX,y:t*PX},this.redraw()}heal(e){spellContext.drawImage(e.image,this.place.x-this.image.width/4,this.place.y,e.width,e.height),this.healPoints<=MAX_HEAL_POINTS-HEAL?this.healPoints+=HEAL:this.healPoints=MAX_HEAL_POINTS,this.effect(),setTimeout(()=>{spellContext.clearRect(this.place.x-this.image.width/4,this.place.y,e.width,e.height)},500)}effect(e){this.clearImage(),setTimeout(()=>{this.clearImage(),this.redraw()},e)}damaged(){this.healPoints-ATTACK>0?(this.healPoints-=ATTACK,this.effect(EFFECT_DURATION)):this.loose()}}class n extends i{constructor(e,t,i,n,a){super(e,t,"player",a),this.score=0,this.image=n,this.redraw(),this.healPoints=MAX_HEAL_POINTS}drawImage(){actorsContext.drawImage(this.image,this.place.x,this.place.y,this.image.width,this.image.height)}drawInfo(){this.drawName(-this.image.width/3),this.drawHP(this.place.x),this.drawLevel()}drawLevel(){actorsContext.font=`${LVL_SIZE*PX}px Verdana`,actorsContext.fillStyle="orange",actorsContext.textAlign="center",actorsContext.fillText(this.score+1,CANVAS_WIDTH/2-this.score*PX,LVL_WRAP*PX+LVL_SIZE*PX)}win(){this.score+=1,s()}loose(){this.healPoints=MAX_HEAL_POINTS}clearImage(){actorsContext.clearRect(this.place.x,this.place.y,this.image.width,this.image.heigth)}}class a extends i{constructor(e,t,i,n,a,s){super(e,t,"enemy",a),this.image={head:s.head,body:s.body,weapon:s.weapon,legs:s.legs,width:n.width,height:n.height},this.healPoints=MAX_HEAL_POINTS,this.redraw()}drawInfo(){this.drawName(this.name.length),this.drawHP(this.image.width/3)}drawImage(){actorsContext.drawImage(this.image.legs,this.place.x-BODY_WIDTH*PX/12,this.place.y+BODY_HEIGHT*PX+HEAD_HEIGHT*PX/3,this.image.legs.width,this.image.legs.heigth),actorsContext.drawImage(this.image.body,this.place.x-BODY_WIDTH*PX/4.2,this.place.y+HEAD_HEIGHT*PX/2,this.image.body.width,this.image.body.heigth),actorsContext.drawImage(this.image.head,this.place.x-BODY_WIDTH*PX/50,this.place.y,this.image.head.width,this.image.head.heigth),actorsContext.drawImage(this.image.weapon,this.place.x-.9*WEAPON_WIDTH*PX,this.place.y+HEAD_HEIGHT*PX-WEAPON_HEIGHT/2*PX,this.image.weapon.width,this.image.weapon.heigth)}loose(){PLAYER.win(),s()}clearImage(){actorsContext.clearRect(this.place.x-this.image.width/2,this.place.y,1.3*this.image.width,this.image.height)}}function s(){const e=new Image;e.width=ENEMY_WIDTH*PX,e.height=ENEMY_HEIGHT*PX,enemyDraw().then(([t,i])=>{ENEMY=new a(CANVAS_WIDTH-ENEMY_WIDTH-4*WRAP,CANVAS_HEIGHT-ENEMY_HEIGHT-.8*VERTICAL_WRAP,"enemy",e,t,i)})}!function(){let e=JSON.parse(localStorage.getItem("user"));e&&e.gender&&e.name&&(function(e,t){const i=new Image,a=Math.ceil(Math.random()*PLAYER_NUM);i.src=`../resources/images/player/hero_${e}_${a}.png`,i.width=PLAYER_WIDTH*PX,i.height=PLAYER_HEIGHT*PX,PLAYER=new n(WRAP/3,CANVAS_HEIGHT-PLAYER_HEIGHT-VERTICAL_WRAP,"player",i,t)}(e.gender,e.name),s())}()},function(e,t){!function(){const e=document.getElementById("spellMenu"),t=document.getElementById("healMenu");SPELLLIST.forEach(i=>{spellElement=function(e){let t=document.createElement("button");t.setAttribute("class","btn btn-primary btn-lg btn-block"),t.textContent=e.name;const i=e.image;return i.width=30*PX,i.height=30*PX,t.appendChild(i),t.setAttribute("data-toggle","modal"),t.setAttribute("data-target","#solveGameTaskModal"),t}(i),"heal"===i.type?(spellElement.addEventListener("click",function(){taskWindowLoader(i,PLAYER,PLAYER)}),t.appendChild(spellElement)):(spellElement.addEventListener("click",function(){taskWindowLoader(i,PLAYER,ENEMY)}),e.appendChild(spellElement))})}()},function(e,t){window.onresize=rebuildCanvas(),setInterval(function(){rebuildCanvas()},500),document.getElementById("loginSubmit").addEventListener("click",function(){let e=document.getElementById("userName").value,t=Array.from(document.querySelectorAll(".user-gender")).filter(e=>e.checked)[0].value;logUserIn(e,t),$("#logInModal").modal("toggle")})},function(e,t){window.onload=function(){document.getElementsByClassName("game-menu")[0].style.top="-"+CANVAS_HEIGHT+"px",localStorage.user?document.getElementById("onlyLoggedUserContent").style.display="block":document.getElementById("logInModalOpener").click()}},function(e,t){document.currentScript.src.split("/").slice(0,-1).join("/")},function(e,t){document.currentScript.src.split("/").slice(0,-1).join("/")},function(e,t){document.currentScript.src.split("/").slice(0,-1).join("/")},function(module,exports){const countingTask=()=>{const signArray=SIGN_ARRAY,sign=signArray[~~(Math.random()*signArray.length)],firstNum=getRandomCountNum(MAX_COUNTING_NUM),secondNum=getRandomCountNum(MAX_COUNTING_NUM),task=`${firstNum} ${sign} ${secondNum}`,answer=eval(task);return[task,answer]},getRandomCountNum=e=>Math.round(Math.random()*e)},function(e,t){},function(e,t){let i=[];class n{constructor(e,t,n,a,s,o,r){this.name=e,this.image=new Image,this.image.src=`${SPELL_IMAGE_PATH}${t}`,this.sound=new Audio(`${SPELL_SOUND_PATH}${n}`),this.width=a*PX,this.height=s*PX,this.step={x:o*PX,y:r*PX},i.push(this)}}new class extends n{constructor(e,t,i,n,a,s,o){super(e,t,i,n,a,s,o),this.type="flying"}}("Fireball","fireball.gif","meteor.mp3",100,100,10,20),new class extends n{constructor(e,t,i,n,a,s,o){super(e,t,i,n,a,0,s),this.type="drop"}}("Meteor","fireball.gif","bzing.ogg",200,200,12),new class extends n{constructor(e,t,i,n,a,s,o){super(e,t,i,n,a,s,0),this.type="straight"}}("Arrow","fireball.gif","meteor.wav",100,100,12),new class extends n{constructor(e,t,i,n,a,s,o){super(e,t,i,n,a,s,o),this.type="jiggling"}}("Star","fireball.gif","meteor.wav",100,100,12,8),new class extends n{constructor(e,t,i,n,a,s,o){super(e,t,i,n,a,0,0),this.type="heal"}}("Heal","heal.png","meteor.mp3",200,200)},function(e,t,i){"use strict";i.r(t);i(10),i(9),i(8),i(7),i(6),i(5),i(4),i(3),i(2),i(1),i(0)}]);